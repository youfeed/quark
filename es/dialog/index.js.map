{"version":3,"sources":["../../src/packages/dialog/index.js"],"names":["CsDialog","HTMLElement","observedAttributes","constructor","shadowRoot","attachShadow","mode","innerHTML","open","getAttribute","title","type","oktext","canceltext","console","log","loading","value","setAttribute","removeAttribute","attributeChangedCallback","name","oldValue","newValue","btnActive","document","activeElement","getElementById","innerText","connectedCallback","remove","autoclose","btnClose","btnCancel","btnSubmit","calcelText","clientWidth","addEventListener","ev","propertyName","focus","body","removeChild","preventDefault","dispatchEvent","CustomEvent","customElements","get","define","dialog","appendChild","arguments","content","onOk","onCancel","Array","prototype","slice","call","onsubmit","oncancel"],"mappings":"AAAA,OAAO,oBAAP;;AAEA,MAAMA,QAAN,SAAuBC,WAAvB,CAAmC;AAEF,aAAlBC,kBAAkB,GAAG;AAAE,WAAO,CAAC,MAAD,EAAS,OAAT,EAAkB,SAAlB,EAA6B,QAA7B,EAAuC,YAAvC,EAAqD,SAArD,CAAP;AAAwE;;AAE1GC,EAAAA,WAAW,GAAG;AACV;AACA,UAAMC,UAAU,GAAG,KAAKC,YAAL,CAAkB;AAAEC,MAAAA,IAAI,EAAE;AAAR,KAAlB,CAAnB;AACAF,IAAAA,UAAU,CAACG,SAAX,GAAwB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAlGQ;AAmGH;;AAEO,MAAJC,IAAI,GAAG;AACP,WAAO,KAAKC,YAAL,CAAkB,MAAlB,MAA4B,IAAnC;AACH;;AAEQ,MAALC,KAAK,GAAG;AACR,WAAO,KAAKD,YAAL,CAAkB,OAAlB,CAAP;AACH;;AAEO,MAAJE,IAAI,GAAG;AACP,WAAO,KAAKF,YAAL,CAAkB,MAAlB,CAAP;AACH;;AAES,MAANG,MAAM,GAAG;AACT,WAAO,KAAKH,YAAL,CAAkB,QAAlB,CAAP;AACH;;AAEa,MAAVI,UAAU,GAAG;AACbC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKN,YAAL,CAAkB,YAAlB,CAAZ,EAA6C,IAA7C;AACA,WAAO,KAAKA,YAAL,CAAkB,YAA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","sourcesContent":["import '../button/index.js';\n\nclass CsDialog extends HTMLElement {\n\n    static get observedAttributes() { return ['open', 'title', 'content', 'oktext', 'canceltext', 'loading'] }\n\n    constructor() {\n        super();\n        const shadowRoot = this.attachShadow({ mode: 'open' });\n        shadowRoot.innerHTML = `\n        <style>\n        :host{\n            position:fixed;\n            display:flex;\n            left:0;\n            top:0;\n            right:0;\n            bottom:0;\n            z-index:-1;\n            background:rgba(0,0,0,.3);\n            visibility:hidden;\n            opacity:0;\n            transition:.3s;\n        }\n        :host([open]){\n            opacity:1;\n            z-index:50;\n            visibility:visible;\n        }\n        .dialog {\n            display:flex;\n            position:relative;\n            margin:auto;\n            box-shadow: 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);\n            box-sizing: border-box;\n            max-width: calc(100vw - 20px);\n            max-height: calc(100vh - 20px);\n            border-radius: 8px;\n            background-color: #fff;\n            opacity:0;\n            transform:scale(0.5);\n            transition:.3s cubic-bezier(.645, .045, .355, 1);\n        }\n        .dialog-content{\n            box-sizing: border-box;\n            display:flex;\n            width: 100%;\n            padding:0 20px;\n            flex:1;\n            flex-direction:column;\n        }\n        :host([open]) .dialog{\n            opacity:1;\n            transform:scale(1);\n        }\n        .dialog-title {\n            line-height: 30px;\n            padding-top: 24px;\n            font-weight: 700;\n            font-size: 18px;\n            color: #4c5161;\n            text-align: center;\n        }\n        .dialog-body {\n            flex: 1;\n            overflow: auto;\n            padding: 10px 0 20px;\n            font-size: 14px;\n            color: #5A6066;\n        }\n        .dialog-footer {\n            padding-bottom: 24px;\n        }\n        .btn-close{\n            position: absolute;\n            right: 0px;\n            top: 0px;\n            border: 0;\n            color: #BCC4CC;\n            font-size: 20px;\n            padding: 0;\n        }\n        .dialog-footer cs-button {\n            min-width: 140px;\n            // width: 100%;\n        }\n        #btn-cancel{\n            // visibility:hidden;\n            // display: none;\n        }\n        :host(:empty) .dialog-body{\n            min-height:0;\n        }\n        </style>\n        <div class=\"dialog\">\n            <div class=\"dialog-content\">\n                <div class=\"dialog-title\" id=\"title\"></div>\n                <cs-button class=\"btn-close\" id=\"btn-close\" icon=\"close\"></cs-button>\n                <div class=\"dialog-body\">\n                    <slot></slot>\n                </div>\n                <div class=\"dialog-footer\" id=\"dialog-footer\">\n                    <cs-button id=\"btn-cancel\"></cs-button>\n                    <cs-button id=\"btn-submit\" type=\"primary\"></cs-button>\n                </div>\n            </div>\n        </div>\n        `\n    }\n\n    get open() {\n        return this.getAttribute('open')!==null;\n    }\n\n    get title() {\n        return this.getAttribute('title');\n    }\n\n    get type() {\n        return this.getAttribute('type');\n    }\n\n    get oktext() {\n        return this.getAttribute('oktext');\n    }\n\n    get canceltext() {\n        console.log(this.getAttribute('canceltext'), 8877);\n        return this.getAttribute('canceltext');\n    }\n\n    get loading() {\n        return this.getAttribute('loading')!==null;\n    }\n    \n    set title(value) {\n        this.setAttribute('title', value);\n    }\n\n    set type(value) {\n        this.setAttribute('type', value);\n    }\n\n    set oktext(value) {\n        this.setAttribute('oktext', value);\n    }\n\n    set canceltext(value) {\n        console.log(value, 88);\n        this.setAttribute('canceltext', value);\n    }\n\n    set open(value) {\n        if(value === null || value === false){\n            this.removeAttribute('open');\n        }else{\n            this.setAttribute('open', '');\n            this.loading && (this.loading = false);\n        }\n    }\n\n    set loading(value) {\n        if(value === null || value === false){\n            this.removeAttribute('loading');\n        }else{\n            this.setAttribute('loading', '');\n        }\n    }\n\n    // custom element 增加、删除或者修改某个属性时被调用\n    attributeChangedCallback (name, oldValue, newValue) {\n        console.log(name, 22);\n        if( name == 'open' && this.shadowRoot){\n            if(newValue !== null){\n                this.btnActive = document.activeElement;\n            }\n        }\n        if( name == 'title'){\n            if(newValue!==null){\n                this.shadowRoot.getElementById('title').innerText = newValue;\n            }\n        }\n        if( name == 'oktext'){\n            if(newValue !== null){\n                this.shadowRoot.getElementById('btn-submit').innerText = newValue;\n                // this.btnSubmit.textContent = newValue;\n            }\n        }\n        if( name == 'canceltext'){\n            if(newValue !== null){\n                this.shadowRoot.getElementById('btn-cancel').innerText = newValue;\n                // this.btnCancel.textContent = newValue;\n            }\n        }\n    }\n\n    connectedCallback() {\n        this.remove = false;\n        this.autoclose = true;\n\n        this.btnClose = this.shadowRoot.getElementById('btn-close');\n        this.btnCancel = this.shadowRoot.getElementById('btn-cancel');\n        this.btnSubmit = this.shadowRoot.getElementById('btn-submit');\n        \n        console.log(this.oktext, this.calcelText, 22222);\n        // 无取消按钮\n        // if(!this.calcelText) {\n        //     this.btnCancel.remove();\n        //     this.shadowRoot.getElementById('dialog-footer').style.display = 'grid';\n        // }\n        // // 无按钮\n        // if(!this.oktext) {\n        //     this.btnSubmit.remove();\n        //     this.shadowRoot.getElementById('dialog-footer').style.display = 'none';\n        // }\n        \n        this.clientWidth;\n        this.shadowRoot.addEventListener('transitionend',(ev)=>{\n            if(ev.propertyName === 'transform' && this.open){\n                this.btnSubmit.focus();\n            }\n            \n            if(ev.propertyName === 'transform' && !this.open){\n                if( this.remove ){\n                    document.body.removeChild(this);\n                }\n                // 创建自定义对象 onclose\n                // this.dispatchEvent(new CustomEvent('close'));\n                this.btnActive && this.btnActive.focus();\n            }\n        })\n\n        this.addEventListener('wheel',(ev)=>{\n            ev.preventDefault();\n        })\n        this.btnClose.addEventListener('click',()=>{\n            this.open = false;\n        })\n\n        // 自定义取消事件 dialog.oncancel\n        this.btnCancel.addEventListener('click',async ()=>{\n            this.dispatchEvent(new CustomEvent('cancel'));\n            this.open = false;\n        })\n        // 自定义确认事件 dialog.onsubmit\n        this.btnSubmit.addEventListener('click',()=>{\n            this.dispatchEvent(new CustomEvent('submit'));\n            if(!this.loading && this.autoclose){\n                this.open = false;\n            }\n        })\n    }\n}\n\n// 标签调用\nif(!customElements.get('cs-dialog')){\n    customElements.define('cs-dialog', CsDialog);\n}\n\n\n// 函数调用\nexport default function() {\n    const dialog = new CsDialog();\n    document.body.appendChild(dialog);\n    dialog.remove = true;\n\n    if( typeof arguments[0] === 'object' ){\n        const { title = '', content = '', oktext = '确定', canceltext = '取消', onOk, onCancel} = Array.prototype.slice.call(arguments)[0];\n        dialog.title = title;\n        dialog.innerHTML = content||'';\n        dialog.oktext = oktext;\n        dialog.canceltext = canceltext;\n        dialog.onsubmit = onOk;\n        dialog.oncancel = onCancel;\n    }\n    dialog.open = true;\n    return dialog;\n}"],"file":"index.js"}