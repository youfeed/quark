{"version":3,"sources":["../../src/packages/dialog/index.js"],"names":["CsDialog","shadowRoot","attachShadow","mode","innerHTML","attributeChangedCallback","name","oldValue","newValue","console","log","btnActive","document","activeElement","getElementById","innerText","connectedCallback","remove","autoclose","btnClose","btnCancel","btnSubmit","oktext","calcelText","clientWidth","addEventListener","ev","propertyName","open","focus","body","removeChild","preventDefault","dispatchEvent","CustomEvent","loading","getAttribute","value","removeAttribute","setAttribute","HTMLElement","customElements","get","define","dialog","appendChild","arguments","Array","prototype","slice","call","title","content","canceltext","onOk","onCancel","onsubmit","oncancel"],"mappings":"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","sourcesContent":["import '../button/index.js';\n\nclass CsDialog extends HTMLElement {\n\n    static get observedAttributes() { return ['open', 'title', 'content', 'oktext', 'canceltext', 'loading'] }\n\n    constructor() {\n        super();\n        const shadowRoot = this.attachShadow({ mode: 'open' });\n        shadowRoot.innerHTML = `\n        <style>\n        :host{\n            position:fixed;\n            display:flex;\n            left:0;\n            top:0;\n            right:0;\n            bottom:0;\n            z-index:-1;\n            background:rgba(0,0,0,.3);\n            visibility:hidden;\n            opacity:0;\n            transition:.3s;\n        }\n        :host([open]){\n            opacity:1;\n            z-index:50;\n            visibility:visible;\n        }\n        .dialog {\n            display:flex;\n            position:relative;\n            margin:auto;\n            box-shadow: 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);\n            box-sizing: border-box;\n            max-width: calc(100vw - 20px);\n            max-height: calc(100vh - 20px);\n            border-radius: 8px;\n            background-color: #fff;\n            opacity:0;\n            transform:scale(0.5);\n            transition:.3s cubic-bezier(.645, .045, .355, 1);\n        }\n        .dialog-content{\n            box-sizing: border-box;\n            display:flex;\n            width: 100%;\n            padding:0 20px;\n            flex:1;\n            flex-direction:column;\n        }\n        :host([open]) .dialog{\n            opacity:1;\n            transform:scale(1);\n        }\n        .dialog-title {\n            line-height: 30px;\n            padding-top: 24px;\n            font-weight: 700;\n            font-size: 18px;\n            color: #4c5161;\n            text-align: center;\n        }\n        .dialog-body {\n            flex: 1;\n            overflow: auto;\n            padding: 10px 0 20px;\n            font-size: 14px;\n            color: #5A6066;\n        }\n        .dialog-footer {\n            padding-bottom: 24px;\n        }\n        .btn-close{\n            position: absolute;\n            right: 0px;\n            top: 0px;\n            border: 0;\n            color: #BCC4CC;\n            font-size: 20px;\n            padding: 0;\n        }\n        .dialog-footer cs-button {\n            min-width: 140px;\n            // width: 100%;\n        }\n        #btn-cancel{\n            // visibility:hidden;\n            // display: none;\n        }\n        :host(:empty) .dialog-body{\n            min-height:0;\n        }\n        </style>\n        <div class=\"dialog\">\n            <div class=\"dialog-content\">\n                <div class=\"dialog-title\" id=\"title\"></div>\n                <cs-button class=\"btn-close\" id=\"btn-close\" icon=\"close\"></cs-button>\n                <div class=\"dialog-body\">\n                    <slot></slot>\n                </div>\n                <div class=\"dialog-footer\" id=\"dialog-footer\">\n                    <cs-button id=\"btn-cancel\"></cs-button>\n                    <cs-button id=\"btn-submit\" type=\"primary\"></cs-button>\n                </div>\n            </div>\n        </div>\n        `\n    }\n\n    get open() {\n        return this.getAttribute('open')!==null;\n    }\n\n    get title() {\n        return this.getAttribute('title');\n    }\n\n    get type() {\n        return this.getAttribute('type');\n    }\n\n    get oktext() {\n        return this.getAttribute('oktext');\n    }\n\n    get canceltext() {\n        console.log(this.getAttribute('canceltext'), 8877);\n        return this.getAttribute('canceltext');\n    }\n\n    get loading() {\n        return this.getAttribute('loading')!==null;\n    }\n    \n    set title(value) {\n        this.setAttribute('title', value);\n    }\n\n    set type(value) {\n        this.setAttribute('type', value);\n    }\n\n    set oktext(value) {\n        this.setAttribute('oktext', value);\n    }\n\n    set canceltext(value) {\n        console.log(value, 88);\n        this.setAttribute('canceltext', value);\n    }\n\n    set open(value) {\n        if(value === null || value === false){\n            this.removeAttribute('open');\n        }else{\n            this.setAttribute('open', '');\n            this.loading && (this.loading = false);\n        }\n    }\n\n    set loading(value) {\n        if(value === null || value === false){\n            this.removeAttribute('loading');\n        }else{\n            this.setAttribute('loading', '');\n        }\n    }\n\n    // custom element 增加、删除或者修改某个属性时被调用\n    attributeChangedCallback (name, oldValue, newValue) {\n        console.log(name, 22);\n        if( name == 'open' && this.shadowRoot){\n            if(newValue !== null){\n                this.btnActive = document.activeElement;\n            }\n        }\n        if( name == 'title'){\n            if(newValue!==null){\n                this.shadowRoot.getElementById('title').innerText = newValue;\n            }\n        }\n        if( name == 'oktext'){\n            if(newValue !== null){\n                this.shadowRoot.getElementById('btn-submit').innerText = newValue;\n                // this.btnSubmit.textContent = newValue;\n            }\n        }\n        if( name == 'canceltext'){\n            if(newValue !== null){\n                this.shadowRoot.getElementById('btn-cancel').innerText = newValue;\n                // this.btnCancel.textContent = newValue;\n            }\n        }\n    }\n\n    connectedCallback() {\n        this.remove = false;\n        this.autoclose = true;\n\n        this.btnClose = this.shadowRoot.getElementById('btn-close');\n        this.btnCancel = this.shadowRoot.getElementById('btn-cancel');\n        this.btnSubmit = this.shadowRoot.getElementById('btn-submit');\n        \n        console.log(this.oktext, this.calcelText, 22222);\n        // 无取消按钮\n        // if(!this.calcelText) {\n        //     this.btnCancel.remove();\n        //     this.shadowRoot.getElementById('dialog-footer').style.display = 'grid';\n        // }\n        // // 无按钮\n        // if(!this.oktext) {\n        //     this.btnSubmit.remove();\n        //     this.shadowRoot.getElementById('dialog-footer').style.display = 'none';\n        // }\n        \n        this.clientWidth;\n        this.shadowRoot.addEventListener('transitionend',(ev)=>{\n            if(ev.propertyName === 'transform' && this.open){\n                this.btnSubmit.focus();\n            }\n            \n            if(ev.propertyName === 'transform' && !this.open){\n                if( this.remove ){\n                    document.body.removeChild(this);\n                }\n                // 创建自定义对象 onclose\n                // this.dispatchEvent(new CustomEvent('close'));\n                this.btnActive && this.btnActive.focus();\n            }\n        })\n\n        this.addEventListener('wheel',(ev)=>{\n            ev.preventDefault();\n        })\n        this.btnClose.addEventListener('click',()=>{\n            this.open = false;\n        })\n\n        // 自定义取消事件 dialog.oncancel\n        this.btnCancel.addEventListener('click',async ()=>{\n            this.dispatchEvent(new CustomEvent('cancel'));\n            this.open = false;\n        })\n        // 自定义确认事件 dialog.onsubmit\n        this.btnSubmit.addEventListener('click',()=>{\n            this.dispatchEvent(new CustomEvent('submit'));\n            if(!this.loading && this.autoclose){\n                this.open = false;\n            }\n        })\n    }\n}\n\n// 标签调用\nif(!customElements.get('cs-dialog')){\n    customElements.define('cs-dialog', CsDialog);\n}\n\n\n// 函数调用\nexport default function() {\n    const dialog = new CsDialog();\n    document.body.appendChild(dialog);\n    dialog.remove = true;\n\n    if( typeof arguments[0] === 'object' ){\n        const { title = '', content = '', oktext = '确定', canceltext = '取消', onOk, onCancel} = Array.prototype.slice.call(arguments)[0];\n        dialog.title = title;\n        dialog.innerHTML = content||'';\n        dialog.oktext = oktext;\n        dialog.canceltext = canceltext;\n        dialog.onsubmit = onOk;\n        dialog.oncancel = onCancel;\n    }\n    dialog.open = true;\n    return dialog;\n}"],"file":"index.js"}